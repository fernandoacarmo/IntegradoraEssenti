CREATE OR REPLACE VIEW ESVINFRAPRODUTOS
AS
  SELECT PCEST.CODFILIAL
       , PCEST.CODPROD
       , PCPRODUT.CODAUXILIAR
       , PCPRODUT.DESCRICAO PRODUTO
       , PCTABPR.PVENDA1
       , PCTABPR.PVENDA2
       , PCTABPR.PVENDA3
       , PCTABPR.PVENDA4
       , PCTABPR.PVENDA5
       , PCTABPR.PVENDA6
       , PCTABPR.PVENDA7
       , NVL(PCEST.QTESTGER,0) - NVL(PCEST.QTBLOQUEADA,0) - NVL(PCEST.QTRESERV,0) QTDISPONIVEL
    FROM PCPRODUT
       , PCEST
       , PCTABPR
       , PCFORNEC
       , PCFILIAL
       , PCCONSUM
   WHERE PCPRODUT.DTEXCLUSAO IS NULL 
     AND PCPRODUT.CODAUXILIAR IS NOT NULL
     AND PCPRODUT.CODAUXILIAR > 0
     AND PCPRODUT.CODPROD = PCEST.CODPROD
     AND PCPRODUT.CODPROD = PCEST.CODPROD
     AND PCFILIAL.CODIGO  = PCEST.CODFILIAL
     AND PCPRODUT.CODFORNEC = PCFORNEC.CODFORNEC
     AND PCTABPR.NUMREGIAO = NVL(PCFILIAL.NUMREGIAOPADRAO, PCCONSUM.NUMREGIAOPADRAO)
     AND NVL(PCFORNEC.CODFORNECPRINC, PCFORNEC.CODFORNEC) = 1
     AND PCEST.CODFILIAL = '1'
     AND PCTABPR.PVENDA1 > 0
     AND PCTABPR.PVENDA2 > 0
     AND PCTABPR.PVENDA3 > 0
     AND PCTABPR.PVENDA4 > 0
     AND PCTABPR.PVENDA5 > 0
     AND PCTABPR.PVENDA6 > 0
     AND PCTABPR.PVENDA7 > 0

